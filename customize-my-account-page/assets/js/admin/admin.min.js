"use strict";jQuery(function($){var currentHref="",$tabs=$("#tgwc-tabs"),$lis=$tabs.find(".dd-item"),$deleteDialog=$("#tgwc-dialog-delete"),$addNewTabDialog=$("#tgwc-dialog-add-tab");$(window).on("load added_endpoint",function(){$('input[name*="enable"]')}),$.each($lis,function(index,li){var href=$(li).find("a").attr("href"),id=$(li).data("id");if(id===window.tgwc_admin.active_endpoint){var $input=$(document).find("#tgwc-active-endpoint").find("input");$input.length&&$($input).val(id);var childMenuWrap=$(li).closest(".child-menu-wrap");if(childMenuWrap.length>0)childMenuWrap.closest("li").find(".tgwc-sidenav-tab-action-wrap").addClass("active");return $(li).find(".tgwc-sidenav-tab-action-wrap").addClass("active"),$(href).addClass("active"),$(href).show(),void(currentHref=href)}$(href).hide()}),$(document).on("keyup",".tgwc-endpoint-slug",function(){var slug=$(this).val();$(document).find("#tgwc-active-endpoint").find("input").val(slug)}),$tabs.on("click",".dd-item a",function(e){e.preventDefault(),e.stopPropagation();var href=$(this).attr("href"),$tabContainer=$(href);if(currentHref!==href){$tabs.find(".tgwc-sidenav-tab-action-wrap").removeClass("active"),$(currentHref).removeClass("active"),$(this).parents(".tgwc-sidenav-tab-action-wrap").first().addClass("active"),$(href).addClass("active");var childMenuWrap=$(this).closest(".child-menu-wrap");if(childMenuWrap.length>0)childMenuWrap.closest(".dd-item").find(".tgwc-sidenav-tab-action-wrap:first").addClass("active");$(currentHref).fadeOut($.proxy(function(){$(this).fadeIn()},$tabContainer));var $input=$(document).find("#tgwc-active-endpoint").find("input");if($input.length){var id=$(this).parents(".dd-item").data("id");$($input).val(id)}currentHref=href}}),$tabs.on("click",".tgwc-add-tab-btn",function(e){e.preventDefault(),$(document).find(".tgwc-sidenav").addClass("tgwc-sidenav--collapsed"),$(document).find(".tgwc-tabs-with-sidenav").removeClass("tgwc-sidecontent-over-shadow"),$(document).find(".tgwc-sidenav-toggle").toggleClass("tgwc-sidenav-toggle--collapsed"),$addNewTabDialog.dialog({resizable:!1,height:"auto",width:400,modal:!0,autoOpen:!0,dialogClass:"tgwc-add-tab-btn",open:function(){$(this).parent(".ui-dialog").find(".tgwc-button--danger:eq(0)").focus()},buttons:[]})}),$tabs.on("click",".tgwc-delete-endpoints",function(e){e.preventDefault();$(this).data("is_free");$(document).find(".tgwc-sidenav").addClass("tgwc-sidenav--collapsed"),$(document).find(".tgwc-tabs-with-sidenav").removeClass("tgwc-sidecontent-over-shadow"),$(document).find(".tgwc-sidenav-toggle").toggleClass("tgwc-sidenav-toggle--collapsed"),$deleteDialog.dialog({resizable:!1,height:"auto",width:400,modal:!0,autoOpen:!0,dialogClass:"tgwc-delete-endpoints",open:function(){$(this).parent(".ui-dialog").find(".tgwc-button--danger:eq(0)").focus(),$(this).parent().find(".tgwc-poup-icon-wrap").length||$(this).parent().find(".ui-dialog-title").prepend("<div class='tgwc-poup-icon-wrap'>"+tgwc.deleteIcon+"</div>")},buttons:[{text:window.tgwc.i18n.cancel,"class":"tgwc-button tgwc-button--link tgwc-endpoint-dialog-form-cancel",tabindex:2,click:function(){$(this).dialog("close")}},{text:window.tgwc.i18n["delete"],"class":"tgwc-button tgwc-button--danger",tabindex:1,click:$.proxy(function(){$deleteDialog.dialog("close");var topPanel=$(this).closest(".tgwc-tabs-with-sidenav"),slug=$(this).data("slug"),$panel=topPanel.find("#"+slug),$tab=$(this).closest("li"),$tabSibling=$tab.siblings(".dd-item").first();$tabSibling.length||($tabSibling=$tab.parents(".dd-item").first()),$tabSibling.first().find("a").first().trigger("click"),$tab.fadeOut(function(){$(this).remove(),$panel.remove()})},this)}]})}),jQuery(document).ready(function($){$(document).on("click",".tgwc_custom_icon_uploader_box, .tgwc_browse_files, .tgwc_uploader_edit_action",function(e){if(e.preventDefault(),e.stopPropagation(),!$(this).hasClass("has_icon")){var $box=$(this).closest(".tgwc_custom_icon_uploader_box"),$input=$box.find(".tgwc-custom-icon-id"),$preview=$box.find(".tgwc-custom-icon-preview"),frame=wp.media({title:"Select or Upload Icon",button:{text:"Use this icon"},multiple:!1});frame.on("select",function(){var attachment=frame.state().get("selection").first().toJSON();$input.val(attachment.id),$preview.find(".attachment-thumbnail").length&&$preview.find(".attachment-thumbnail").remove(),attachment.sizes&&attachment.sizes.thumbnail?$preview.append('<img class="attachment-thumbnail size-thumbnail" src="'+attachment.sizes.thumbnail.url+'" />'):$preview.append('<img class="attachment-thumbnail size-thumbnail" src="'+attachment.url+'" />'),$preview.siblings(".tgwc_custom_icon_uploader_inner_content_wrapper ").addClass("tgwc_hidden").addClass("has_icon"),$preview.closest(".tgwc_custom_icon_uploader_box ").addClass("has_icon"),$preview.removeClass("tgwc_hidden")}),frame.open()}}),$(".tgwc_custom_icon_uploader_box").each(function(){var $box=$(this),$input=$box.find(".tgwc-custom-icon-id"),$preview=$box.find(".tgwc-custom-icon-preview");$box.on("drag dragstart dragend dragover dragenter dragleave drop",function(e){e.preventDefault(),e.stopPropagation()}).on("dragover dragenter",function(){$box.addClass("is-dragover")}).on("dragleave dragend drop",function(){$box.removeClass("is-dragover")}).on("drop",function(e){if(!$box.hasClass("has_icon")){var droppedFiles=e.originalEvent.dataTransfer.files;droppedFiles.length>0&&function(file,$input,$preview){var $spinner=$input.closest(".tgwc_custom_icon_uploader_box").find(".tgwc-loader");$spinner.show();var data=new FormData;data.append("file",file),data.append("action","tgwc_handle_dropped_icon"),data.append("security",tgwc_admin.tgwc_upload_nonce),data.append("endpoint_key",$input.closest(".tgwc_custom_icon_uploader_box").data("endpoint-key")),$.ajax({url:tgwc_admin.ajaxurl,type:"POST",data:data,contentType:!1,processData:!1,success:function(response){if(response.success){var attachmentId=response.data.attachment.id;attachmentId&&($input.val(attachmentId),wp.media.attachment(attachmentId).fetch().then(function(attachment){$preview.find(".attachment-thumbnail").length&&$preview.find(".attachment-thumbnail").remove(),attachment.sizes&&attachment.sizes.thumbnail?$preview.append('<img class="attachment-thumbnail size-thumbnail" src="'+attachment.sizes.thumbnail.url+'" />'):$preview.append('<img class="attachment-thumbnail size-thumbnail" src="'+attachment.url+'" />'),$spinner.hide(),$preview.siblings(".tgwc_custom_icon_uploader_inner_content_wrapper ").addClass("tgwc_hidden").addClass("has_icon"),$preview.closest(".tgwc_custom_icon_uploader_box ").addClass("has_icon"),$preview.removeClass("tgwc_hidden")}))}else alert("Error: "+response.data.message)},error:function(){alert("Error uploading file")}})}(droppedFiles[0],$input,$preview)}})}),$(document).on("click",".tgwc_uploader_delete_action",function(e){e.preventDefault(),e.stopPropagation();var $preview=$(this).closest(".tgwc-custom-icon-preview"),$input=$preview.siblings(".tgwc-custom-icon-id");$preview.siblings(".tgwc_custom_icon_uploader_inner_content_wrapper ").removeClass("has_icon").removeClass("tgwc_hidden"),$preview.closest(".tgwc_custom_icon_uploader_box  ").removeClass("has_icon"),$input.val(""),$preview.addClass("tgwc_hidden"),$preview.find(".attachment-thumbnail").remove()}),$(document).on("change",".tgwc_choose_icon_type_radio_input",function(){var $el=$(this),chooseType=$el.val(),endpointType=$el.data("endpoint_type");$el.closest(".tgwc_choose_icon_type_inner_wrapper").addClass("active").siblings().removeClass("active"),"choose_icon"===chooseType?($("#tgwc_choose_icon_"+endpointType).removeClass("tgwc_hidden"),$("#tgwc_custom_icon_uploader_"+endpointType).addClass("tgwc_hidden")):"custom_icon_upload"===chooseType&&($("#tgwc_choose_icon_"+endpointType).addClass("tgwc_hidden"),$("#tgwc_custom_icon_uploader_"+endpointType).removeClass("tgwc_hidden"))}),$(document).on("click",".tgwc_choose_icon_type_inner_wrapper",function(e){"INPUT"!==e.target.tagName&&$(this).find('input[type="radio"]').prop("checked",!0).trigger("change")})})}),function($,tgwc){var $icons=$('select[name$="[icon]"]');$.fn.select2.amd.require(["select2/data/array","select2/utils"],function(ArrayData,Utils){function CustomData($element,options){CustomData.__super__.constructor.call(this,$element,options)}Utils.Extend(CustomData,ArrayData),CustomData.prototype.query=function(params,callback){var results=[];results=params.term&&""!==params.term?_.filter(tgwc.icons,function(e){return e.text.toUpperCase().indexOf(params.term.toUpperCase())>=0}):tgwc.icons,"page"in params||(params.page=1);var data={};data.results=results.slice(50*(params.page-1),50*params.page),data.pagination={},data.pagination.more=50*params.page<results.length,callback(data)},$.each($icons,function(index,icon){$(icon).select2({placeholder:tgwc.i18n.selectAnIcon,allowClear:!0,ajax:{},dataAdapter:CustomData,escapeMarkup:function(markup){return markup}});var selectedIcon=$(icon).data("selected");if(""!==selectedIcon||undefined!==selectedIcon){var text=selectedIcon.replace("fas fa-","");text=`<i class="${selectedIcon}"></i> ${text=(text=text.replace("-"," ")).charAt(0).toUpperCase()+text.slice(1)}`;var newOption=new Option(text,selectedIcon,!0,!0);$(icon).append(newOption).trigger("change")}})})}(jQuery,window.tgwc),jQuery(function($){var $tabs=$("#tgwc-tabs"),$endpointDialog=$("#tgwc-endpoint-dialog"),$endpointDialogType=$("#tgwc-endpoint-dialog-type"),$endpointDialogName=$("#tgwc-endpoint-dialog-name");function addTab(form){var name=$endpointDialogName.val(),type=$endpointDialogType.val(),slug=(type.substring(0,1).toUpperCase(),textToID(name));slug=function(slug){var firstCharacter=(slug=(slug=slug.replace(/[^\w- ]+/g,"")).trim()).substring(0,1);"-"!==firstCharacter&&"_"!==firstCharacter||(slug=slug.substring(1,slug.length));var lastCharacter=(slug=slug.trim()).substring(slug.length-1,slug.length);"-"!==lastCharacter&&"_"!==lastCharacter||(slug=slug.substring(0,slug.length-1));slug="#"+slug;var $anchors=$tabs.find("li a"),hrefs=$.map($anchors,function(anchor){return $(anchor).attr("href")});hrefs=hrefs.concat(["#pagename","#page","#page_id","#preview"]);for(;hrefs.indexOf(slug)>-1;)slug+=1;return slug.substr(1)}(slug);var icon="endpoint"==type?tgwc.endpointIcon:"group"==type?tgwc.groupIcon:tgwc.linkIcon,li=[`<li class="dd-item ${type}" data-id="${slug}" data-type="${type}">\n    <div class="tgwc-sidenav-tab-anchor-wrap">\n\t<div class="tgwc_dd_custom_handle" >\n\t<svg class="dd-custom-handle" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">\n\t  <path d="m20 11 .102.005a1 1 0 0 1 0 1.99L20 13H4a1 1 0 1 1 0-2h16Zm0-6 .102.005a1 1 0 0 1 0 1.99L20 7H4a1 1 0 0 1 0-2h16Zm0 12 .102.005a1 1 0 0 1 0 1.99L20 19H4a1 1 0 1 1 0-2h16Z"></path>\n\t</svg>\n\t</div>\n      <div class="tgwc-sidenav-tab-action-wrap">`,`<a class="tgwc-sidenav-tab-anchor" href="#${slug}">\n        <div class="type-wrap">\n          <div class="${type}">\n            ${icon}\n            <span class="label">${name}</span>\n          </div>\n        </div>\n      </a>\n      <div class="actions-wrap">\n        <div class="tgwc-toggle-section">\n          <span class="tgwc-toggle-form">\n            <input type="checkbox"\n              checked\n              name="tgwc_endpoints[${slug}][enable]"\n              style="min-width: 350px;" />\n            <span class="slider round"></span>\n          </span>\n        </div>\n        <button type="button" class="tgwc-button tgwc-button--small tgwc-delete-endpoints" data-slug="${slug}">\n          ${tgwc.deleteIcon}\n        </button>\n\t\t</div>${"group"===type?'<ul class="dd-list child-menu-wrap no-child"><div class="dd-drop-item-container">Drag items here to group</div></ul>':""}`,"</div>\n    </div>\n  </li>"].join("");if(""===name)return $(form).find(".tgwc-error-message").html("Empty name is not allowed."),!1;var template=wp.template(`tgwc-${type}`);$tabs.find(".dd-list").first().append(li),$tabs.find(".tgwc-sidecontent").append(template({slug:slug,text:name,type:type,i18n:window.tgwc.i18n})),$(`#tgwc-${slug}`).hide(0),$(document).trigger("added_endpoint"),$.fn.select2.amd.require(["select2/data/array","select2/utils"],function(ArrayData,Utils){function CustomData($element,options){CustomData.__super__.constructor.call(this,$element,options)}Utils.Extend(CustomData,ArrayData),CustomData.prototype.query=function(params,callback){var results=[];results=params.term&&""!==params.term?_.filter(window.tgwc.icons,function(e){return e.text.toUpperCase().indexOf(params.term.toUpperCase())>=0}):window.tgwc.icons,"page"in params||(params.page=1);var data={};data.results=results.slice(50*(params.page-1),50*params.page),data.pagination={},data.pagination.more=50*params.page<results.length,callback(data)},$(`select[name$="tgwc_endpoints[${slug}][icon]"]`).select2({placeholder:window.tgwc.i18n.selectAnIcon,allowClear:!0,ajax:{},dataAdapter:CustomData,escapeMarkup:function(markup){return markup}})}),$(`select[name$="tgwc_endpoints[${slug}][user_role]"]`).select2({placeholder:tgwc.i18n.selectUserRoles,allowClear:!0,multiple:!0,data:window.tgwc.roles}),$(".settings-table-wrapper .select2-selection").each(function(index,select){$(select).append('<span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>')});var textAreaId=`tgwc_endpoints_${slug}_content`;return wp.editor.initialize(textAreaId,{tinymce:{wpautop:!0,plugins:"charmap colorpicker compat3x directionality fullscreen hr image lists media paste tabfocus textcolor wordpress wpautoresize wpdialogs wpeditimage wpemoji wpgallery wplink wptextpattern wpview",toolbar1:"bold italic underline strikethrough | bullist numlist | blockquote hr wp_more | alignleft aligncenter alignright | link unlink | fullscreen | wp_adv",toolbar2:"formatselect alignjustify forecolor | pastetext removeformat charmap | outdent indent | undo redo | wp_help",media_strict:!1,setup:function(editor){editor.on("init",function(){window.tgwcSmartTagsButton&&($(document).find("#wp-tgwc_endpoints_"+slug+"_content-wrap").find(".wp-media-buttons").append(window.tgwcSmartTagsButton),$(document).find(".wp-core-ui.wp-editor-wrap").css({width:"100%"}),$(document).find(".wp-editor-container").find("textarea").css({width:"100%"}))})}},quicktags:!0,mediaButtons:!0}),$tabs.find(".dd-item").last().find("a").trigger("click"),$('[data-toggle="tgwc-tooltip"]').tooltip({position:{my:"center top-120%",at:"center top",collision:"none"},tooltipClass:"tgwc-tooltip"}),initializeSelect2(),!0}function initializeSelect2(){jQuery(document).ready(function($){$(".tgwc_custom_content_position").select2({placeholder:"Choose content position...",minimumResultsForSearch:Infinity}),$(".tgwc_settings_default_endpoints").select2({placeholder:"Choose default Endpoint...",minimumResultsForSearch:Infinity})})}$(".tgwc-endpoint-actions").on("click","button",function(e){if(e.preventDefault(),$(this).hasClass("tgwc-add-tab-btn"))return $(document).find(".tgwc-sidenav").addClass("tgwc-sidenav--collapsed"),$(document).find(".tgwc-tabs-with-sidenav").removeClass("tgwc-sidecontent-over-shadow"),$(document).find(".tgwc-sidenav-toggle").toggleClass("tgwc-sidenav-toggle--collapsed"),void $("#tgwc-dialog-add-tab").dialog({resizable:!1,height:"auto",width:400,modal:!0,autoOpen:!0,dialogClass:"tgwc-add-tab-btn",open:function(){$(this).parent(".ui-dialog").find(".tgwc-button--danger:eq(0)").focus()},buttons:[]});$(".ui-dialog-content").dialog("close");var type=$(this).data("type");$endpointDialogType.val(type);var icon="endpoint"==type?tgwc.endpointIcon:"link"===type?tgwc.linkIcon:tgwc.groupIcon;$endpointDialog.dialog({draggable:!1,resizable:!1,autoOpen:!0,modal:!0,title:`Add ${type}`,minWidth:460,buttons:[{text:window.tgwc.i18n.cancel,"class":"tgwc-button tgwc-button--link tgwc-endpoint-dialog-form-cancel",tabindex:2,click:function(){$(this).dialog("close")}},{text:`${window.tgwc.i18n.add} ${type}`,"class":"tgwc-button tgwc-button--primary tgwc-endpoint-dialog-form-add",tabindex:1,click:function(){addTab(this)&&$(this).dialog("close")}}],open:function(){$(this).parent().find(".tgwc-poup-icon-wrap").length||$(this).parent().find(".ui-dialog-title").prepend("<div class='tgwc-poup-icon-wrap "+type+"'>"+icon+"</div>")},close:function(){$endpointDialog.find("form").get(0).reset(),$endpointDialog.find(".tgwc-error-message").html("")}})}),$("body").on("keydown","#tgwc-endpoint-dialog",function(e){e.keyCode===$.ui.keyCode.ENTER&&(addTab(this)&&$(this).dialog("close"),e.preventDefault(),e.stopPropagation())}),$(document.body).on("click","#tgwc-smart-tags-selector",function(){var $this=$(this);$(this).siblings(".select-smart-tags").select2({placeholder:"",templateResult:function(data,container){return $this.siblings(".tgwc_advance_setting").length>0&&data.element&&$(container).addClass("tgwc-select-smart-tag"),data.text}}).on("select2:open",function(){$(".select2-container--open .select2-dropdown").addClass("tgwc-select2-dropdown")}),$(this).siblings(".select2-container").addClass("tgwc-hide-select2"),$(this).siblings(".select-smart-tags").select2("open"),$(this).siblings(".select2-container").find(".select2-selection__rendered").show(),$(this).siblings(".select2-container").find(".select2-selection--open").show();var buttonOffset=$(this).offset(),buttonOffsetTop=Math.round(buttonOffset.top+$(this).innerHeight()),buttonOffsetRight=Math.round(buttonOffset.left),select2_container=$(".select2-container--open:not(.tgwc-hide-select2)");select2_container.css({top:buttonOffsetTop,left:buttonOffsetRight-$(this).innerHeight()-10});var newDiv='<span class="tgwc-select2-title"><p>'+tgwc_admin.smart_tags_dropdown_title+"</p></span>";$(newDiv).insertBefore(select2_container.find(".select2-search"));var searchField=select2_container.find(".select2-search__field");searchField.attr("placeholder",tgwc_admin.smart_tags_dropdown_search_placeholder),searchField.before('<span class="search-icon"><svg xmlns="http://www.w3.org/2000/svg" height="16px" width="16px" viewBox="0 0 24 24" fill="#a1a4b9"><path d="M21.71,20.29,18,16.61A9,9,0,1,0,16.61,18l3.68,3.68a1,1,0,0,0,1.42,0A1,1,0,0,0,21.71,20.29ZM11,18a7,7,0,1,1,7-7A7,7,0,0,1,11,18Z"></path></svg></span>'),$(".select-smart-tags").on("change",function(event){event.preventDefault(),event.stopPropagation();const selectedValue=$(this).val();if(!selectedValue)return;const $textarea=$(this).closest(".wp-editor-wrap").find("textarea"),editorId=$textarea.attr("id"),editor=window.tinymce&&window.tinymce.get(editorId);if(editor&&!editor.isHidden())editor.insertContent(selectedValue);else{const textarea=$textarea[0],startPos=textarea.selectionStart,endPos=textarea.selectionEnd;textarea.value=textarea.value.substring(0,startPos)+selectedValue+textarea.value.substring(endPos),textarea.selectionStart=textarea.selectionEnd=startPos+selectedValue.length,$textarea.trigger("input")}$(this).val("").trigger("change.select2")})}),initializeSelect2()}),function($){function initSortableList($list){new Sortable($list[0],{group:{name:"nested",pull:!0,put:function(to,from,dragEl){const dragType=$(dragEl).data("type"),targetType=$(to.el).closest(".dd-item").data("type");return"group"!==dragType||"group"!==targetType}},animation:150,fallbackOnBody:!0,swapThreshold:.65,handle:".tgwc_dd_custom_handle",ghostClass:"dd-ghost",chosenClass:"dragging",dragClass:"dd-drag",onChange:function(evt){$(".dd-list.child-menu-wrap").each(function(){0===$(this).find(".dd-item").length?($(this).addClass("no-child"),$(this).find(".dd-drop-item-container").removeClass("tgwc-hide")):$(this).find(".dd-item").length>0&&($(this).removeClass("no-child"),$(this).find(".dd-drop-item-container").addClass("tgwc-hide"))})}})}function customSerialize(){var result=[];return $(".dd > .dd-list > .dd-item").each(function(){result.push(function processItem($item){var item={id:$item.data("id"),type:$item.data("type"),children:[]};$item.find(".dd-list > .dd-item").each(function(){item.children.push(processItem($(this)))});return item}($(this)))}),result}function removeUrlError(input){input.closest(".col-input").find(".error").remove()}function correctAndValidateUrl(url){if(!url)return{isValid:!1,corrected:url};if("#"===url||/^#\w+/.test(url))return{isValid:!0,corrected:url};const originalUrl=url;/^(https?|ftp):\/\//i.test(url)||(/^www\./i.test(url)||/^[a-z0-9-]+(\.[a-z0-9-]+)+/i.test(url))&&(url="https://"+url),/^http:\/\//i.test(url)&&(url=url.replace(/^http:\/\//i,"https://"));const isValid=/^(https?|ftp):\/\/[^\s/$.?#].[^\s]*$/i.test(url);return{isValid:isValid,corrected:isValid?url:originalUrl,wasCorrected:isValid&&url!==originalUrl}}$(".dd-list").each(function(){initSortableList($(this))}),new MutationObserver(function(mutations){mutations.forEach(function(mutation){$(mutation.addedNodes).each(function(){const $node=$(this);if($node.is(".dd-item.group")){const $childList=$node.find(".child-menu-wrap").first();$childList.length&&initSortableList($childList)}})})}).observe($(".dd-list").first()[0],{childList:!0,subtree:!0}),$("#tgwc-customization-form").submit(function(e){if($(".dd").length){var data=customSerialize(),input=`<input type='hidden' name='tgwc_endpoints[endpoints_order]' value='${data=JSON.stringify(data)}' />`;$(this).append(input);var linkInput=$(this).find(".tgwc-tabs-panel.active").find(".tgwc-link-url");if(linkInput.length>0){var url=linkInput.val().trim(),correctedUrl=correctAndValidateUrl(url);if(!correctedUrl.isValid)return removeUrlError(linkInput),linkInput.after('<span class="error">'+tgwc_admin.tgwc_link_url_err+"</span>"),e.preventDefault(),!1;correctedUrl.corrected!==url&&linkInput.val(correctedUrl.corrected)}}}),$(".tgwc-link-url").on("keyup change",function(){var url=$(this).val().trim();removeUrlError($(this));var result=correctAndValidateUrl(url);result.isValid?result.corrected!==url&&$(this).val(result.corrected):$(this).after('<span class="error">'+tgwc_admin.tgwc_link_url_err+"</span>")})}(jQuery),function($){$("#tgwc-endpoints").find('select[name$="[user_role][]"]').each(function(index,userRole){var $userRole=$(userRole);$userRole.select2({placeholder:window.tgwc.i18n.selectUserRoles,multiple:!0,allowClear:!0,data:window.tgwc.roles}),$userRole.val($userRole.data("selected")),$userRole.trigger("change")}),$(".settings-table-wrapper .select2-selection").each(function(index,select){$(select).append('<span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>'),$(select).find("input").attr("style","")})}(jQuery),function($){var data=window.tgwc,$settingsForm=$("#tgwc-customization-form"),$restoreDefaultsDialog=$("#tgwc-dialog-restore-defaults"),$setting=$("#tgwc-restore-defaults-settings"),$customization=$("#tgwc-restore-defaults-customization"),$debug=$("#tgwc-restore-defaults-debug-settings"),$formInputs=$settingsForm.find("input, select, textarea").filter(function(){return this.name&&this.name.startsWith("tgwc_endpoints")}),$isFormSaved=!0,$saveChangesDialog=$("#tgwc-dialog-save-changes");$formInputs.each(function(index,element){const $element=$(element);$element.is('input[type="text"], textarea, select')?$(document).on("keyup undo redo",element,function(){$isFormSaved&&($isFormSaved=!1)}):$element.is('input[type="checkbox"], input[type="radio"]')&&$element.on("change",function(){$isFormSaved&&($isFormSaved=!1)})}),$("#customizer_tab").on("click",function(e){if(!$isFormSaved){e.preventDefault();var $this=$(this);$saveChangesDialog.dialog({resizable:!1,height:"auto",width:400,modal:!0,autoOpen:!0,dialogClass:"tgwc-dialog-save-changes",open:function(){$(this).parent(".ui-dialog").find(".tgwc-button--danger:eq(0)").focus(),$(this).parent().find(".tgwc-poup-icon-wrap").length||$(this).parent().find(".ui-dialog-title").prepend("<div class='tgwc-poup-icon-wrap'>"+tgwc.alertTriangleIcon+"</div>")},buttons:[{text:window.tgwc.i18n.discard,"class":"tgwc-button tgwc-button--danger tgwc-endpoint-dialog-form-cancel",tabindex:2,click:function(){$(this).dialog("close"),window.location=$this.attr("href")}},{text:window.tgwc.i18n.save,"class":"tgwc-button tgwc-button--primary",tabindex:1,click:function(){$(this).dialog("close"),$("#tgwc-submit").trigger("click")}}]})}}),$setting.add($customization).add($debug).change(function(e){e.preventDefault();var $noticeContainer=$("#tgwc-dialog-restore-defaults").find(".tgwc-dialog-notice"),title="",message="",noticeId=$(this).attr("id")+"-notice";"tgwc-restore-defaults-settings-notice"===noticeId?(title=data.i18n.settings,message=data.i18n.restoreSettingsInfo):"tgwc-restore-defaults-customization-notice"===noticeId&&(title=data.i18n.designCustomization,message=data.i18n.restoreCustomizationInfo);var html=['<div class="notice notice-warning" style="display: none" id="'+noticeId+'">',"<p>","<strong>"+title+": </strong>",message,"</p>","</div>"].join("");$(this).prop("checked")?($noticeContainer.append(html),$("#"+noticeId).fadeIn()):$("#"+noticeId).fadeOut(function(){$(this).remove()})}),$("#tgwc-reset").click(function(e){e.preventDefault(),$("#tgwc-dialog-restore-defaults").dialog({modal:!0,resizable:!1,minWidth:460,dialogClass:"tgwc-dialog-restore-defaults",open:function(){$(this).parent().find(".tgwc-poup-icon-wrap").length||$(this).parent().find(".ui-dialog-title").prepend("<div class='tgwc-poup-icon-wrap'>"+tgwc.alertTriangleIcon+"</div>")},buttons:[{text:window.tgwc.i18n.cancel,"class":"tgwc-button tgwc-button--link tgwc-endpoint-dialog-form-cancel",tabindex:2,click:function(){$(this).dialog("close")}},{text:window.tgwc.i18n.reset,"class":"tgwc-button tgwc-button--danger tgwc-endpoint-dialog-form-add",tabindex:1,click:function(){var $setting=$restoreDefaultsDialog.find("#tgwc-restore-defaults-settings"),$customization=$restoreDefaultsDialog.find("#tgwc-restore-defaults-customization");$settingsForm.find("input[name^=tgwc_reset_options]").remove();var html="";$setting.prop("checked")&&(html+='<input type="hidden" name="tgwc_reset_options[setting]" value="setting" />'),$customization.prop("checked")&&(html+='<input type="hidden" name="tgwc_reset_options[customization]" value="customization" />'),$debug.prop("checked")&&(html+='<input type="hidden" name="tgwc_reset_options[debug]" value="debug" />'),$settingsForm.append(html),$("#tgwc-submit").trigger("click"),$(this).dialog("close")}}],close:function(){$restoreDefaultsDialog.find("form").get(0).reset(),$restoreDefaultsDialog.find(".notice").hide()}})})}(jQuery),jQuery(function($){$('[data-toggle="tgwc-tooltip"]').tooltip({position:{my:"center top-120%",at:"center top",collision:"none"},tooltipClass:"tgwc-tooltip"}),$('[data-toggle="tgwc-tooltip-down"]').tooltip({position:{my:"center top+10",at:"center bottom",collision:"none"},tooltipClass:"tgwc-tooltip-down"})}),function($){var $container=$("#tgwc-customization"),data=window.tgwc;$container.on("keyup keydown",'input[name$="[label]"]',function(e){e.keyCode===$.ui.keyCode.ENTER&&e.preventDefault();var label=$(this).val(),isValid=!0,errorMessage="",panelId=$(this).parents(".tgwc-tabs-panel.active").first().attr("id"),eroorLabel=$("#tgwc-tabs").find('[data-id="'+panelId+'"]').find(".dd3-content").text().trim().substring(4);$(this).parents(".tgwc-tabs-panel.active").find(".tgwc-tabs-panel-header h2").html(label),$('.dd-item[data-id="'+panelId+'"]').find(".tgwc-sidenav-tab-anchor span:nth-child(3)").html(label),$(this).siblings(".error").remove(),""===label&&(errorMessage=data.i18n.labelCannotBeEmpty,$(this).after('<span class="error">'+errorMessage+"</span>"),isValid=!1),$(this).data("isValid",isValid),$(this).data("error",{label:eroorLabel,message:errorMessage})}),$container.on("keyup keydown",'input[name$="[slug]"]',function(e){e.keyCode===$.ui.keyCode.ENTER&&e.preventDefault();var currentSlug=$(this).parents(".tgwc-tabs-panel.active").attr("id"),panelId=$(this).parents(".tgwc-tabs-panel.active").first().attr("id"),label=$("#tgwc-tabs").find('[data-id="'+panelId+'"]').find(".dd3-content").text().trim().substring(4),slug=$(this).val().toLowerCase(),message=data.i18n.available,errorMessage="",$endpoints=$container.find("li.endpoint"),cssClass="notice-success",isValid=!0,endpoints=$.map($endpoints,function(endpoint){var slug=$(endpoint).data("id");if(currentSlug!==slug)return slug});(endpoints=endpoints.concat(["pagename","page","page_id","preview"])).indexOf(slug)>=0&&(message=data.i18n.notAvailable,errorMessage=data.i18n.notAvailable,cssClass="notice-error",isValid=!1),/^[a-zA-Z0-9]+[\w-]*[a-zA-Z0-9]$/g.test(slug)||(message=data.i18n.slugMustBeginWith,errorMessage=data.i18n.slugMustBeginWith,cssClass="notice-error",isValid=!1),/^[\w-]+$/g.test(slug)||(message=data.i18n.slugCanOnlyContains,errorMessage=data.i18n.slugCanOnlyContains,cssClass="notice-error",isValid=!1),slug.length<3&&(message=data.i18n.slugMustBeOfLength,errorMessage=data.i18n.slugMustBeOfLength,cssClass="notice-error",isValid=!1),""===slug&&(message=data.i18n.slugCannotBeEmpty,errorMessage=data.i18n.slugCannotBeEmpty,cssClass="notice-error",isValid=!1),$(this).siblings(".notice").remove(),$(this).closest(".col-input").css({"flex-direction":"column"}),$(this).after('<span class="notice '+cssClass+'">'+message+"</span>"),$(this).data("isValid",isValid),$(this).data("error",{label:label,message:errorMessage}),this.value=slug}),$container.on("keyup keydown",'input[name$="[class]"]',function(e){e.keyCode===$.ui.keyCode.ENTER&&e.preventDefault()}),$container.find("form").submit(function(e){var isValid=!0,errorHtml="",$inputs=$container.find('input[name$="[slug]"], input[name$="[label]"] ');$.each($inputs,function(index,input){var valid=$(input).data("isValid"),error=$(input).data("error"),html="";valid=undefined===valid||valid,isValid=isValid&&valid,valid||(html=['<div class="notice notice-error">',"<p>","<strong>"+error.label+": </strong>",error.message,"</p>","</div>"].join("")),errorHtml+=html}),isValid||(e.preventDefault(),$("<div/>").html('<div class="tgwc-dialog-content"><span class="ui-icon ui-icon-alert"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-alert-triangle"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg></span><div class="tgwc-dialog-content__detail"><p>'+data.i18n.resolveFormErrors+'</p></div></div><div class="tgwc-dialog-content-list">'+errorHtml+"</div>").dialog({title:data.i18n.couldNotSaveChanges,dialogClass:"no-close",resizable:!1,width:"400px",modal:!0,buttons:[{text:data.i18n.ok.toUpperCase(),"class":"tgwc-button tgwc-button--link tgwc-endpoint-dialog-form-cancel",click:function(){$(this).dialog("close")}}]}))}),$(document).on("click",".tgwc-sidenav-toggle",function(e){e.preventDefault();var $this=$(this);$this.closest(".tgwc-sidenav").toggleClass("tgwc-sidenav--collapsed"),$(document).find(".tgwc-tabs-with-sidenav").toggleClass("tgwc-sidecontent-over-shadow"),$this.toggleClass("tgwc-sidenav-toggle--collapsed")}),$('input[name="tgwc_endpoints[customer-logout][enable]"]').on("change",function(){if(tgwc_admin.customizer_logout_btn_enabled)return $(this).prop("checked",!$(this).is(":checked")),!1})}(jQuery);